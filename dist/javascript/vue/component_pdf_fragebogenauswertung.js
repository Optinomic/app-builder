Vue.component("pdf-auswertung-gesamt",{props:{production:{type:Boolean,default:!0}},data:()=>({name:"Fallkonferenz",title:"Fragebogenauswertung",subtitle:"Eine Übersicht der wichtigsten Ergebnisse und Auswertungen.",pdf_status:"Initialisiere",pdf_create_count:0,pdf_building:!1,pdf_finished:!1,pdf_content:[],needed_apps_data:{production:[{name:"actinfo_ein",title:"act-info",subtitle:"Information network on addiction care and therapy",app_id:"ch.suedhang.apps.actinfo_ein.production"},{name:"actinfo_aus",title:"act-info",subtitle:"Information network on addiction care and therapy",app_id:"ch.suedhang.apps.actinfo_aus.production"},{name:"tmt",title:"TMT",subtitle:"Trail Making Test",app_id:"ch.suedhang.apps.tmt.production"},{name:"bdi",title:"BDI-II",subtitle:"Beck Depressions-Inventar",app_id:"ch.suedhang.apps.bdi.production"},{name:"asrs",title:"",subtitle:"",app_id:"ch.suedhang.apps.asrs.production"},{name:"aase",title:"AASE-G",subtitle:"Alcohol Abstinence Self-Effcacy | Skala Versuchung",app_id:"ch.suedhang.apps.aase-g.production"},{name:"bscl",title:"BSCL",subtitle:"Brief Symptom Checklist",app_id:"ch.suedhang.apps.bscl_anq.production"},{name:"isk",title:"ISK-K",subtitle:"Inventar Sozialer Kompetenzen - Kurzform",app_id:"ch.suedhang.apps.isk.production"},{name:"whoqol",title:"WHOQOL-BREF",subtitle:"WHO Quality of Life - Kurzform",app_id:"ch.suedhang.apps.whoqol.production"},{name:"sci",title:"SCI",subtitle:"Stress-Coping-Inventar",app_id:"ch.suedhang.apps.sci.production"},{name:"rs13",title:"RS-13",subtitle:"Resilienzfragebogen",app_id:"ch.suedhang.apps.rs13.production"}]}}),methods:{doPDF(){try{this.pdf_building=!0;var pdf=[],base=this.$store.state.data_apps.base.slice();console.warn("doPDF :: Building PDF",base),this.pdf_status="Wird erstellt...";var app_title=function(data){var titel=[];return titel.push(makepdf._horizontalLine(100,"#E0E0E0")),titel.push(makepdf._heading(data.title,data.subtitle,"h1")),titel.push(makepdf._text(data.module.short_description)),makepdf._keepTogether(titel,data.name+"_titel")}.bind(this),titelseite=function(){var block=[];block.push(makepdf._suedhang_logo_anschrift()),block.push(makepdf._title(this.title,this.subtitle)),block.push({text:"Wir berichten über den Aufenthalt von "+this.patient_extras.anrede+" vom "+this.stay_from_to+".",style:"p"}),block.push(makepdf._spacer(96)),block.push(makepdf._horizontalLine(62,"#F5F5F5")),block.push(makepdf._stamp(this.patient_extras.full_name,18)),block.push(makepdf._horizontalLine(62,"#F5F5F5"));var title_block={id:"document_title",alignment:"left",margin:[0,18,0,0],columns:[{},{width:"480",stack:block}]};return this.pdf_create_count=this.pdf_create_count+1,title_block}.bind(this);pdf.push(titelseite()),pdf.push(makepdf._pageBreak());var actinfo=function(){var pdf=[];try{var data_ein=this.getAppBaseData("actinfo_ein"),data_aus=this.getAppBaseData("actinfo_aus");pdf=this.pdf_build_actinfo(data_ein,data_aus);this.pdf_create_count=this.pdf_create_count+1}catch(e){pdf.push(makepdf._keepTogether(makepdf._indication("!","Error"),"actinfo_error"))}return this.pdf_create_count=this.pdf_create_count+1,pdf}.bind(this);pdf.push(actinfo());var tmt=function(){var data=this.getAppBaseData("tmt");console.error("tmt",data);var block=[];return block.push(app_title(data)),block.push(makepdf._keepTogether(makepdf._indication("!","ToDo"),data.name+"_todo")),this.pdf_create_count=this.pdf_create_count+1,block}.bind(this);pdf.push(tmt());var bdi=function(){var data=this.getAppBaseData("bdi");console.error("bdi",data);var block=[];return block.push(app_title(data)),block.push(makepdf._keepTogether(makepdf._indication("!","ToDo"),data.name+"_todo")),this.pdf_create_count=this.pdf_create_count+1,block}.bind(this);pdf.push(bdi());var aase=function(){var data=this.getAppBaseData("aase");console.error("aase",data);var block=[];return block.push(app_title(data)),block.push(makepdf._keepTogether(makepdf._indication("!","ToDo"),data.name+"_todo")),this.pdf_create_count=this.pdf_create_count+1,block}.bind(this);pdf.push(aase());var whoqol=function(){var data=this.getAppBaseData("whoqol");console.error("whoqol",data);var block=[];return block.push(app_title(data)),block.push(makepdf._keepTogether(makepdf._indication("!","ToDo"),data.name+"_todo")),this.pdf_create_count=this.pdf_create_count+1,block}.bind(this);pdf.push(whoqol());var isk=function(){var data=this.getAppBaseData("isk");console.error("isk",data);var block=[];return block.push(app_title(data)),block.push(makepdf._keepTogether(makepdf._indication("!","ToDo"),data.name+"_todo")),this.pdf_create_count=this.pdf_create_count+1,block}.bind(this);pdf.push(isk());var sci=function(){var data=this.getAppBaseData("sci");console.error("sci",data);var block=[];return block.push(app_title(data)),block.push(makepdf._keepTogether(makepdf._indication("!","ToDo"),data.name+"_todo")),this.pdf_create_count=this.pdf_create_count+1,block}.bind(this);pdf.push(sci());var rs13=function(){var data=this.getAppBaseData("rs13");console.error("rs13",data);var block=[];return block.push(app_title(data)),block.push(makepdf._keepTogether(makepdf._indication("!","ToDo"),data.name+"_todo")),this.pdf_create_count=this.pdf_create_count+1,block}.bind(this);pdf.push(rs13()),this.pdf_status="Erstellt!",this.pdf_content=pdf,this.pdf_finished=!0}catch(err){this.pdf_status="Fehler beim Erstellen.",console.error("doPDF",err)}},getAppBaseData(app_name){try{var da=this.$store.state.data_apps.base.slice(),return_obj={};return da.forEach(function(app){app.name===app_name&&(return_obj=Object.assign({},app),this.patient_modules.forEach(function(pm){pm.identifier===return_obj.app_id&&(return_obj.module=Object.assign({},pm.module))}.bind(this)))}.bind(this)),return_obj}catch(err){return console.error("buildAppTitle",err),null}}},computed:{patient_modules(){try{return this.$store.state.apps.data.patient_modules}catch(err){return[]}},data_apps_array(){try{var da=this.$store.state.data_apps.base.slice();return da.forEach(function(app,appID){"pdf_created"in app||(app.pdf_created=!1)}.bind(this)),da}catch(e){return[]}},readyforPDF(){try{var ret_val=!0;return this.$store.state.data_apps.base.slice().forEach(function(app,appID){!0!==app.loaded&&(ret_val=!1)}.bind(this)),!1===this.$store.state.stays.current.found&&(ret_val=!1),ret_val}catch(e){return!1}},stay_from_to(){try{return this.$store.state.stays.current.data.extras.from_to}catch(e){return""}},patient_secure(){try{return this.$store.state.patient.data.extras.secure}catch(e){return""}},patient_extras(){try{return this.$store.state.patient.data.extras}catch(e){return""}}},watch:{readyforPDF:function(ready){ready&&this.doPDF()}},created(){try{if(this.production){var init={base:this.needed_apps_data.production.slice(),count:0,data_init_array:[],data_loaded_array:[]};this.$store.commit({type:"saveData",root:"data_apps",data:init}),this.pdf_status="Daten werden geladen...",this.needed_apps_data.production.forEach(function(app,appID){var params={identifier:app.app_id,root:app.app_id};this.$store.dispatch("getSurveyResponses",params)}.bind(this))}}catch(err){console.error("created",err)}},template:'\n    <div>\n        <div v-if="!pdf_finished" class="pt-2">\n\n            <div v-if="pdf_building" class="d-flex flex-row justify-space-between align-center mr-4">\n                <div class="mb-3 mr-2">\n                    <v-icon color="#8b0042">mdi-file-pdf</v-icon>\n                </div>\n                <p class="mr-auto mt-2" v-text="pdf_status"></p>\n\n                <div v-for="index in this.pdf_create_count" :key="index" style="margin-top:-12px;">\n                    <v-badge class="ml-4" color="green" dot> </v-badge>\n                </div>\n                <div v-for="index in data_apps_array.length - this.pdf_create_count" :key="index" style="margin-top:-12px;">\n                    <v-badge class="ml-4" color="blue" dot> </v-badge>\n                </div>\n            </div>\n            <div v-else class="d-flex flex-row justify-space-between align-center mr-4">\n                <div class="mb-3 mr-2">\n                    <v-icon color="#8b0042">mdi-file-pdf</v-icon>\n                </div>\n                <p class="mr-auto mt-2" v-text="pdf_status"></p>\n\n                <div v-for="app in data_apps_array" style="margin-top:-12px;">\n                    <v-badge class="ml-4" v-if="(app.init === true) && (app.loaded !== true)  && (app.pdf_created !== true)" color="grey"\n                        dot> </v-badge>\n                    <v-badge class="ml-4" v-if="(app.init === true) && (app.loaded === true)  && (app.pdf_created !== true)" color="blue"\n                        dot></v-badge>\n                </div>\n            </div>\n\n        </div>\n        <div v-else>\n            <optinomic-pdfmake :header-left="patient_secure" :footer-left="title" header-right="Klinik Südhang"\n                :document-title="title" :content="pdf_content" hide-logo></optinomic-pdfmake>\n        </div>\n    </div>\n    '});